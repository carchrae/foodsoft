- article=group_order_article.order_article.article
- price= group_order_article.order_article.price.fc_price
- min = group_order_article.quantity
- tolerance = group_order_article.tolerance
- max = min+tolerance
- ordered = min<max ? "#{min}..#{max}" : "#{min}"
- result = group_order_article.result
- price_per_unit = "#{article.unit} @ #{number_to_currency(price)}"
- total = number_to_currency(result * price)

- diff = diff || {}
- old_min = diff['quantity'] || min
- old_max = old_min + (diff['tolerance'] || tolerance)
- old_unit = (diff['unit']) || article.unit
- old_price = (diff['fc_price'] || price).to_f
- old_result = (diff['result'] || result).to_f
- old_ordered = old_max > old_min ? "#{old_min}..#{old_max}" : "#{old_min}"
- old_price_per_unit = "#{old_unit} @ #{number_to_currency(old_price)}"
- old_total = number_to_currency(old_result * old_price)


- strikeCell='{  text-decoration: line-through; margin-top: 0; margin-bottom: 0 }'
- tdStyle= '{ vertical-align: bottom }'
- tdStyleRight= '{ text-align: right; vertical-align: bottom }'

%tr
  %td{ style: tdStyle }
    - if (old_ordered!=ordered)
      %p
        %strike= old_ordered
    = ordered
  %td{ style: tdStyle }
    %p{style: strikeCell}= old_result if (old_result!=result)
    = result
  %td{ style: tdStyleRight }
    %p{style: strikeCell}= old_price_per_unit if (old_price_per_unit != price_per_unit)
    = price_per_unit
  %td{ style: tdStyle }
    %p{style: strikeCell}= diff['name'] if (diff['name'] != article.name)
    = article.name
  %td{ style: tdStyleRight }
    %p{style: strikeCell}= old_total if (old_total != total)
    = total


